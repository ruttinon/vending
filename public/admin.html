<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Dashboard</title>
  <link rel="stylesheet" href="dark-dashboard.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <script>
<<<<<<< HEAD
=======
    window.addEventListener("DOMContentLoaded", () => {
      if (!localStorage.getItem("adminLoggedIn")) {
        window.location.href = "admin-login.html"; // ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ login ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
      }
    });
  </script>
<script>
>>>>>>> f8ae43cd7cdb60f9367994b0ed4151e06f3845ec
    const firebaseConfig = {
      apiKey: "AIzaSyDhI8i5kimRPcJgEIKw0UmlaT2sN70Yazk",
      authDomain: "this-pro-done.firebaseapp.com",
      databaseURL: "https://this-pro-done-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "this-pro-done",
      storageBucket: "this-pro-done.appspot.com",
      messagingSenderId: "735519750080",
<<<<<<< HEAD
      appId: "1:735519750080:web:226c4c7b1d7ba03420fa25"
    };
    firebase.initializeApp(firebaseConfig);

    window.addEventListener("DOMContentLoaded", () => {
      if (!localStorage.getItem("adminLoggedIn")) {
        window.location.href = "admin-login.html";
      }
    });
  </script>
</head>

<body>
<div class="dashboard">
  <aside class="sidebar">
    <h2>Admin</h2>
    <nav>
      <a href="#" class="active" onclick="showSection('dashboard')">üìä Dashboard</a>
      <a href="#" onclick="showSection('products')">üì¶ Products</a>
      <a href="#" onclick="showSection('sales')">üìà Sales Report</a>
      <a href="#" onclick="showSection('settings')">‚öôÔ∏è Settings</a>
      <a href="#" onclick="logout()">üö™ Logout</a>
    </nav>
  </aside>

  <main class="main">
    <header><h1 id="section-title">Dashboard</h1></header>

    <section id="dashboard" class="main-section">
      <div class="charts">
        <div class="chart-box">
          <h3>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô</h3>
          <canvas id="dailyRevenueChart"></canvas>
        </div>
        <div class="chart-box">
          <h3>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
          <canvas id="salesByFootTypeChart"></canvas>
        </div>
        <div class="chart-box">
          <h3>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</h3>
          <canvas id="lowStockChart"></canvas>
        </div>
      </div>
    </section>

    <section id="products" class="main-section" style="display:none">
      <h2>üì¶ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>

      <div class="admin-container">
        <h3>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà</h3>
        <label>‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
        <input type="text" id="newProductName">
        <label>‡∏£‡∏≤‡∏Ñ‡∏≤ (THB)</label>
        <input type="number" id="newProductPrice">
        <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</label>
        <input type="number" id="newProductStock">
        <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏ó‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°</label>
        <select id="newProductFootType">
          <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏ó‡πâ‡∏≤ --</option>
          <option value="0 Normal Foot">‡πÄ‡∏ó‡πâ‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥</option>
          <option value="1 Flat Foot">‡πÄ‡∏ó‡πâ‡∏≤‡πÅ‡∏ö‡∏ô</option>
          <option value="2 Higharch Foot">‡πÄ‡∏ó‡πâ‡∏≤‡πÇ‡∏Ñ‡πâ‡∏á‡∏™‡∏π‡∏á</option>
        </select>
        <label>‡∏•‡∏¥‡∏á‡∏Å‡πå URL ‡∏£‡∏π‡∏õ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
        <input type="text" id="newProductImage" placeholder="https://example.com/your-image.jpg">
        <button onclick="addNewProduct()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>
      </div>

      <div class="admin-container">
        <h3>‡πÄ‡∏û‡∏¥‡πà‡∏°/‡∏•‡∏î‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
        <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
        <select id="productSelect"></select>
        <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏î</label>
        <input type="number" id="stockAmount">
        <div style="display: flex; gap: 10px; margin-top: 10px;">
          <button onclick="addStockToProduct()">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏ï‡πá‡∏≠‡∏Å</button>
          <button onclick="reduceStockFromProduct()">‚ûñ ‡∏•‡∏î‡∏™‡∏ï‡πá‡∏≠‡∏Å</button>
        </div>
      </div>

      <div class="admin-container">
        <h3>‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
        <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö</label>
        <select id="deleteProductSelect"></select>
        <button style="margin-top:10px;" onclick="deleteProduct()">üóëÔ∏è ‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>
      </div>

      <div class="admin-container">
        <button onclick="goToStore()">üîô ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
      </div>
    </section>
    <section id="sales" class="main-section" style="display:none">
      <h2>üìà ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢</h2>
      <div class="admin-container">
        <p>üßæ ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°: <span id="totalSold">-</span> ‡∏ä‡∏¥‡πâ‡∏ô</p>
        <p>üí∞ ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏°: <span id="totalRevenue">-</span> ‡∏ö‡∏≤‡∏ó</p>
      </div>
      <div class="chart-box">
        <h3>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏ó‡πâ‡∏≤</h3>
        <canvas id="salesByTypeChart"></canvas>
      </div>
      <div class="chart-box">
        <h3>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ Top 5 ‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</h3>
        <canvas id="topProductsChart"></canvas>
      </div>
    </section>

    <section id="settings" class="main-section" style="display:none">
      <h2>‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</h2>
      <p>Browser: <span id="browserInfo">Loading...</span></p>
      <p>Language: <span id="langInfo">Loading...</span></p>
      <p>Time Zone: <span id="tzInfo">Loading...</span></p>
    </section>
  </main>
</div>

<!-- Scripts -->
<script>
const BASE_URL = "https://this-pro-done-default-rtdb.asia-southeast1.firebasedatabase.app";
const PRODUCTS_URL = `${BASE_URL}/products.json`;

async function loadProductOptions() {
  try {
    const response = await fetch(PRODUCTS_URL);
    const products = await response.json();
    
    const productSelect = document.getElementById("productSelect");
    const deleteProductSelect = document.getElementById("deleteProductSelect");
    productSelect.innerHTML = "";
    deleteProductSelect.innerHTML = "";

    if (products) {
      Object.entries(products).forEach(([id, data]) => {
        const option1 = document.createElement("option");
        option1.value = id;
        option1.textContent = data.name + (data.stock === 0 ? " (‡∏´‡∏°‡∏î)" : "");
        productSelect.appendChild(option1);

        const option2 = document.createElement("option");
        option2.value = id;
        option2.textContent = data.name;
        deleteProductSelect.appendChild(option2);
      });
    }
  } catch (err) {
    alert("‚ùå ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß");
    console.error(err);
  }
}

async function addNewProduct() {
  const name = document.getElementById("newProductName").value;
  const price = Number(document.getElementById("newProductPrice").value);
  const stock = Number(document.getElementById("newProductStock").value);
  const footType = document.getElementById("newProductFootType").value;
  const image = document.getElementById("newProductImage").value;

  if (!name || price <= 0 || stock < 0 || !footType) {
    alert("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö!");
    return;
  }

  const newProduct = { name, price, stock, footType, visible: true, sold: 0, image: image || "" };

  try {
    const response = await fetch(PRODUCTS_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(newProduct)
    });

    if (response.ok) {
      alert("‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");
      loadProductOptions();
    } else {
      alert("‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ");
    }
  } catch (err) {
    alert("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏Ç‡∏ì‡∏∞‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•");
    console.error(err);
  }
}

async function addStockToProduct() {
  const productId = document.getElementById("productSelect").value;
  const amount = Number(document.getElementById("stockAmount").value);

  if (amount <= 0 || !productId) {
    alert("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£!");
    return;
  }

  try {
    const response = await fetch(`${BASE_URL}/products/${productId}.json`);
    const product = await response.json();
    const newStock = (product.stock || 0) + amount;

    await fetch(`${BASE_URL}/products/${productId}.json`, {
      method: "PATCH",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ stock: newStock })
    });

    alert("‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");
    loadProductOptions();
  } catch (err) {
    alert("‚ùå ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß");
    console.error(err);
  }
}

async function reduceStockFromProduct() {
  const productId = document.getElementById("productSelect").value;
  const amount = Number(document.getElementById("stockAmount").value);

  if (amount <= 0 || !productId) {
    alert("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£!");
    return;
  }

  try {
    const response = await fetch(`${BASE_URL}/products/${productId}.json`);
    const product = await response.json();
    let newStock = (product.stock || 0) - amount;

    if (newStock < 0) newStock = 0;

    await fetch(`${BASE_URL}/products/${productId}.json`, {
      method: "PATCH",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ stock: newStock })
    });

    alert("‚úÖ ‡∏•‡∏î‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");
    loadProductOptions();
  } catch (err) {
    alert("‚ùå ‡∏•‡∏î‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß");
    console.error(err);
  }
}

async function deleteProduct() {
  const productId = document.getElementById("deleteProductSelect").value;

  if (!productId) {
    alert("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö!");
    return;
  }

  if (!confirm("‚ö†Ô∏è ‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ô‡∏µ‡πâ?")) {
    return;
  }

  try {
    await fetch(`${BASE_URL}/products/${productId}.json`, {
      method: "DELETE"
    });
    alert("‚úÖ ‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!");
    loadProductOptions();
  } catch (err) {
    alert("‚ùå ‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß");
    console.error(err);
  }
}

function goToStore() {
  window.location.href = "index_backup.html";
}

function showSection(sectionId) {
  const sections = document.querySelectorAll(".main-section");
  sections.forEach(section => section.style.display = "none");
  document.getElementById(sectionId).style.display = "block";
  document.getElementById("section-title").textContent = document.querySelector(`[onclick="showSection('${sectionId}')"]`).textContent;
}

function logout() {
  localStorage.removeItem("adminLoggedIn");
  window.location.href = "index_backup.html";
}

window.addEventListener("DOMContentLoaded", loadProductOptions);
document.getElementById('browserInfo').textContent = navigator.userAgent;
document.getElementById('langInfo').textContent = navigator.language;
document.getElementById('tzInfo').textContent = Intl.DateTimeFormat().resolvedOptions().timeZone;
</script>

</body>
</html>

=======
      appId: "1:735519750080:web:226c4c7b1d7ba03420fa25",
      measurementId: "G-Y4N2ERD40J"
    };
    firebase.initializeApp(firebaseConfig);
  </script>
</head>
<body>
  <div class="dashboard">
    <aside class="sidebar">
      <h2>Admin</h2>
      <nav>
        <a href="#" class="active" onclick="showSection('dashboard')">üìä Dashboard</a>
        <a href="#" onclick="showSection('products')">üì¶ Products</a>
        <a href="#" onclick="showSection('sales')">üìà Sales Report</a>
        <a href="#" onclick="showSection('settings')">‚öôÔ∏è Settings</a>
        <a href="#" onclick="logout()">üö™ Logout</a>
      </nav>
    </aside>

    <main class="main">
      <header><h1 id="section-title">Dashboard</h1></header>

      <section id="dashboard" class="main-section">
        <div class="charts">
          <div class="chart-box">
            <h3>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô</h3>
            <canvas id="dailyRevenueChart"></canvas>
          </div>
          <div class="chart-box">
            <h3>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
            <canvas id="salesByFootTypeChart"></canvas>
          </div>
          <div class="chart-box">
            <h3>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</h3>
            <canvas id="lowStockChart"></canvas>
          </div>
        </div>
      </section>

      <section id="products" class="main-section" style="display:none">
        <h2>üì¶ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
      
        <div class="admin-container">
          <h3>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà</h3>
          <label>‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
          <input type="text" id="newProductName">
      
          <label>‡∏£‡∏≤‡∏Ñ‡∏≤ (THB)</label>
          <input type="number" id="newProductPrice">
      
          <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</label>
          <input type="number" id="newProductStock">
      
          <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏ó‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°</label>
          <select id="newProductFootType">
            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏ó‡πâ‡∏≤ --</option>
            <option value="normal">‡πÄ‡∏ó‡πâ‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥ (normal)</option>
            <option value="flat">‡πÄ‡∏ó‡πâ‡∏≤‡πÅ‡∏ö‡∏ô (flat)</option>
            <option value="higharch">‡πÄ‡∏ó‡πâ‡∏≤‡πÇ‡∏Ñ‡πâ‡∏á‡∏™‡∏π‡∏á (higharch)</option>
          </select>
      
          <button onclick="addNewProduct()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>
        </div>
      
        <div class="admin-container">
          <h3>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
          <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
          <select id="productSelect"></select>
      
          <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°</label>
          <input type="number" id="stockAmount">
      
          <button onclick="addStockToProduct()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏ï‡πá‡∏≠‡∏Å</button>
        </div>
      
        <div class="admin-container">
          <button onclick="goToStore()">üîô ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
        </div>
      </section>
      
      <script>
        const BASE_URL = "https://this-pro-done-default-rtdb.asia-southeast1.firebasedatabase.app";
        const PRODUCTS_URL = `${BASE_URL}/products.json`;
      
        async function loadProductOptions() {
          try {
            const response = await fetch(PRODUCTS_URL);
            const products = await response.json();
            const productSelect = document.getElementById("productSelect");
            productSelect.innerHTML = "";
      
            if (products) {
              Object.entries(products).forEach(([id, data]) => {
                const option = document.createElement("option");
                option.value = id;
                option.textContent = data.name;
                productSelect.appendChild(option);
              });
            }
          } catch (err) {
            alert("‚ùå ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß");
            console.error(err);
          }
        }
      
        async function addNewProduct() {
          const name = document.getElementById("newProductName").value;
          const price = Number(document.getElementById("newProductPrice").value);
          const stock = Number(document.getElementById("newProductStock").value);
          const footType = document.getElementById("newProductFootType").value;
      
          if (!name || price <= 0 || stock < 0 || !footType) {
            alert("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö!");
            return;
          }
      
          const newProduct = {
            name,
            price,
            stock,
            footType,
            visible: true,
            sold: 0 // ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏¥‡∏•‡∏î‡πå sold
          };
      
          try {
            const response = await fetch(PRODUCTS_URL, {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(newProduct)
            });
      
            if (response.ok) {
              alert("‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");
              loadProductOptions();
            } else {
              alert("‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ");
            }
          } catch (err) {
            alert("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏Ç‡∏ì‡∏∞‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•");
            console.error(err);
          }
        }
      
        async function addStockToProduct() {
          const productId = document.getElementById("productSelect").value;
          const amount = Number(document.getElementById("stockAmount").value);
      
          if (amount <= 0 || !productId) {
            alert("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£!");
            return;
          }
      
          try {
            const response = await fetch(`${BASE_URL}/products/${productId}.json`);
            const product = await response.json();
            const newStock = (product.stock || 0) + amount;
      
            await fetch(`${BASE_URL}/products/${productId}.json`, {
              method: "PATCH",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ stock: newStock })
            });
      
            alert("‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");
            loadProductOptions();
          } catch (err) {
            alert("‚ùå ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß");
            console.error(err);
          }
        }
      
        function goToStore() {
          window.location.href = "index_backup.html";
        }
      
        window.addEventListener("DOMContentLoaded", loadProductOptions);
      </script>
      
      

        <section id="sales" class="main-section" style="display:none">
          <h2>üìà ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢</h2>
          <div class="admin-container">
            <p>üßæ ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°: <span id="totalSold">-</span> ‡∏ä‡∏¥‡πâ‡∏ô</p>
            <p>üí∞ ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏°: <span id="totalRevenue">-</span> ‡∏ö‡∏≤‡∏ó</p>
          </div>
        
          <div class="chart-box">
            <h3>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏ó‡πâ‡∏≤</h3>
            <canvas id="salesByTypeChart"></canvas>
          </div>
        
          <div class="chart-box">
            <h3>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ Top 5 ‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</h3>
            <canvas id="topProductsChart"></canvas>
          </div>
        </section>
        
        <script>
          async function fetchSalesData() {
            const dbRef = firebase.database().ref("products");
            const snapshot = await dbRef.once("value");
            return snapshot.val();
          }
        
          async function renderSalesReport() {
            const data = await fetchSalesData();
            let totalSold = 0;
            let totalRevenue = 0;
            const typeCount = {};
            const topProducts = [];
        
            Object.values(data || {}).forEach(product => {
              const sold = product.sold || 0;
              const price = product.price || 0;
              const type = product.footType || "‡∏≠‡∏∑‡πà‡∏ô‡πÜ";
        
              totalSold += sold;
              totalRevenue += sold * price;
              typeCount[type] = (typeCount[type] || 0) + sold;
              topProducts.push({ name: product.name, sold });
            });
        
            // Update summary
            document.getElementById("totalSold").textContent = totalSold;
            document.getElementById("totalRevenue").textContent = totalRevenue.toLocaleString();
        
            // Chart by foot type
            new Chart(document.getElementById("salesByTypeChart"), {
              type: "bar",
              data: {
                labels: Object.keys(typeCount),
                datasets: [{
                  label: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ",
                  data: Object.values(typeCount),
                  backgroundColor: "#3b82f6"
                }]
              }
            });
        
            // Top 5 selling products
            topProducts.sort((a, b) => b.sold - a.sold);
            const top = topProducts.slice(0, 5);
            new Chart(document.getElementById("topProductsChart"), {
              type: "bar",
              data: {
                labels: top.map(p => p.name),
                datasets: [{
                  label: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ",
                  data: top.map(p => p.sold),
                  backgroundColor: "#10b981"
                }]
              }
            });
          }
        </script>

<section id="settings" class="main-section" style="display:none">
  <h2>‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</h2>
  <p>Browser: <span id="browserInfo">Loading...</span></p>
  <p>Language: <span id="langInfo">Loading...</span></p>
  <p>Time Zone: <span id="tzInfo">Loading...</span></p>

  <section class="section">
    <h2>üîê ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</h2>
    <label>‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏î‡∏¥‡∏°</label>
    <input type="password" placeholder="********">
    <label>‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</label>
    <input type="password">
    <label>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</label>
    <input type="password">
    <button onclick="alert('‚úÖ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (mock)')">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</button>
  </section>

  <section class="section">
    <h2>‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</h2>
    <label>‡∏™‡∏Å‡∏∏‡∏•‡πÄ‡∏á‡∏¥‡∏ô</label>
    <select><option>THB</option><option>USD</option></select>
    <label>‡∏†‡∏≤‡∏©‡∏≤</label>
    <select><option>‡πÑ‡∏ó‡∏¢</option><option>English</option></select>
    <label>‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</label>
    <input type="date">
  </section>

  <section class="section">
    <h2>üì¶ ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</h2>
    <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î</label>
    <input type="number" value="5">
    <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
    <select><option value="true">‡πÅ‡∏™‡∏î‡∏á</option><option value="false">‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á</option></select>
  </section>

  <section class="section">
    <h2>üßæ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h2>
    <button onclick="alert('üì• Export CSV (mock)')">üì• Export ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô (CSV)</button>
    <button onclick="alert('üì• Export JSON (mock)')">üì• Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>
  </section>

  <section class="section danger">
    <h2>üö® ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
    <button onclick="confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?') && alert('üßπ ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ (mock)')">üßπ ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏ö‡∏ö</button>
  </section>
</section>
</main>
</div>

<script>
document.getElementById('browserInfo').textContent = navigator.userAgent;
document.getElementById('langInfo').textContent = navigator.language;
document.getElementById('tzInfo').textContent = Intl.DateTimeFormat().resolvedOptions().timeZone;

function showSection(sectionId) {
const sections = document.querySelectorAll(".main-section");
sections.forEach(section => section.style.display = "none");
document.getElementById(sectionId).style.display = "block";
document.getElementById("section-title").textContent = document.querySelector(`[onclick="showSection('${sectionId}')"]`).textContent;
}
</script>

<script> 
src="product-manager.js"</script>

 <!-- ‚úÖ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô logout ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î -->
 <script>
  function logout() {
  console.log("Logging out...");
  localStorage.removeItem("adminLoggedIn");
  window.location.href = "index_backup.html"; // ‚úÖ ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤ index.html ‡∏´‡∏•‡∏±‡∏á logout
}
</script>
</body>
</html>
>>>>>>> f8ae43cd7cdb60f9367994b0ed4151e06f3845ec
